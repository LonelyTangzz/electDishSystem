# 🧑‍🍳 厨师工作台功能说明

## 功能概述

厨师页面是专门为厨房工作人员设计的订单管理界面，可以实时查看和处理顾客订单。

---

## 📱 页面结构

### 1. 顶部统计栏
显示三个关键数据：
- **待处理**: 新订单数量（需要接单）
- **制作中**: 正在制作的订单数量
- **今日完成**: 今天已完成的订单总数

### 2. 标签切换
三个标签页快速切换：
- **待处理** - 新进订单，等待接单
- **制作中** - 已接单，正在制作
- **已完成** - 历史完成订单

### 3. 订单卡片
每个订单显示：
- 订单编号和时间
- 顾客姓名
- 备注信息（如有）
- 菜品明细（带 emoji）
- 订单总金额
- 操作按钮

---

## 🎯 订单状态流程

```
待处理 (pending)
    ↓
  接单 ✅
    ↓
制作中 (cooking)
    ↓
完成出餐 ✅
    ↓
已完成 (completed)
```

**拒单流程**：
```
待处理 (pending) → 拒单 ❌ → 已取消 (cancelled)
```

---

## 🔧 功能详解

### 1️⃣ 待处理订单

**可执行操作**：
- **接单制作** - 确认接单并开始制作
- **拒单** - 拒绝订单（需确认）

**显示信息**：
- 订单时间（智能显示：刚刚/X分钟前/今天 XX:XX）
- 顾客联系人
- 菜品清单和数量
- 特殊备注（黄色高亮）
- 订单总金额

### 2️⃣ 制作中订单

**可执行操作**：
- **完成出餐** - 标记订单已完成

**显示信息**：
- 同待处理订单
- 状态徽章显示为蓝色"制作中"

### 3️⃣ 已完成订单

**显示信息**：
- 完成时间
- 订单详情（只读）
- 状态徽章显示为绿色"已完成"

---

## 🎨 UI 特性

### 颜色方案
- **主色调**: 浅绿色 (#66BB6A)
- **待处理**: 橙色标签
- **制作中**: 蓝色标签
- **已完成**: 绿色标签
- **已取消**: 红色标签

### 智能时间显示
- 1 分钟内：**刚刚**
- 1 小时内：**X分钟前**
- 今天：**今天 HH:MM**
- 其他：**MM-DD HH:MM**

### 菜品 Emoji 映射
每道菜都有对应的 emoji 图标：
- 🍗 宫保鸡丁
- 🥩 鱼香肉丝
- 🧊 麻婆豆腐
- 🍖 红烧排骨
- 🐟 清蒸鲈鱼
- 🥒 拍黄瓜
- 🍄 凉拌木耳
- 🍅 番茄蛋花汤
- 🍜 兰州拉面
- 🥟 煎饺
- 🧋 奶茶
- ... 更多

---

## 🔐 权限控制

### 当前模式（演示）
- 所有登录用户都可以访问厨师页面
- 适合开发测试和演示

### 生产环境建议
在实际部署时，应该实现严格的权限控制：

#### 方法1：数据库权限表
```javascript
// 在云数据库创建 chefs 集合
{
  "openid": "厨师的openid",
  "name": "厨师姓名",
  "role": "chef",
  "status": "active"
}

// 在 chef.js 中检查
async checkChefPermission() {
  const res = await db.collection('chefs')
    .where({ openid: this.data.openid, status: 'active' })
    .get();
  return res.data.length > 0;
}
```

#### 方法2：云函数验证
```javascript
// 调用云函数验证身份
const res = await wx.cloud.callFunction({
  name: 'checkRole',
  data: { role: 'chef' }
});
if (!res.result.isChef) {
  // 无权限，跳转
}
```

---

## 🔄 刷新机制

### 自动刷新
- 每次进入页面（onShow）自动刷新订单列表
- 任何操作（接单/拒单/完成）后自动刷新

### 手动刷新
- 点击右下角浮动的"🔄"按钮
- 支持下拉刷新（enablePullDownRefresh）

---

## 📊 数据库集合

### orders 集合字段
```javascript
{
  _id: "订单ID",
  orderNumber: "订单编号",
  openid: "顾客openid",
  contactPerson: "联系人",
  remark: "备注",
  items: [
    {
      id: "菜品ID",
      name: "菜品名称",
      price: 38.0,
      quantity: 2,
      subtotal: 76.0
    }
  ],
  totalAmount: 76.0,
  status: "pending|cooking|completed|cancelled",
  createTime: Date,
  updateTime: Date,
  completedTime: Date  // 完成时间（可选）
}
```

---

## 💡 使用场景

### 场景1：早高峰
- 待处理标签显示大量新订单
- 厨师快速浏览并批量接单
- 按时间顺序制作

### 场景2：特殊备注
- 黄色备注框醒目提示
- 例如："不要辣"、"多加香菜"等
- 避免制作失误

### 场景3：今日统计
- 查看"今日完成"数量
- 了解营业状况
- 结束营业时核对订单数

---

## 🚀 后续优化方向

### 功能增强
- [ ] 订单提醒音效
- [ ] 预计完成时间
- [ ] 订单优先级标记
- [ ] 批量操作（批量接单）
- [ ] 订单打印功能
- [ ] 厨师绩效统计

### 技术优化
- [ ] WebSocket 实时推送新订单
- [ ] 订单数据分页加载
- [ ] 离线缓存支持
- [ ] 订单搜索功能
- [ ] 数据导出（Excel）

### 权限管理
- [ ] 多级权限（主厨、副厨、帮厨）
- [ ] 操作日志记录
- [ ] 权限动态配置

---

## 📱 访问方式

在小程序底部 TabBar 点击 **"厨房"** 标签即可进入厨师工作台。

---

## ⚠️ 注意事项

1. **权限问题**: 当前演示模式允许所有用户访问，生产环境务必添加权限验证
2. **数据安全**: 订单包含顾客信息，注意数据保护
3. **操作确认**: 所有状态变更都需要确认，避免误操作
4. **网络依赖**: 需要云开发环境，Demo模式无法使用

---

**厨师工作台让订单处理更高效！** 🎉

